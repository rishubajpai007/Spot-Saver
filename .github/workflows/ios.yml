name: iOS CI

on:
  push:
    branches: [ main ]
  pull_request:

jobs:
  build-test:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v4

    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: latest-stable

    # ðŸ‘‡ DEBUG STEP: This lists all files so you can check the correct path in logs
    - name: List files (Debug)
      run: ls -R

    - name: Install dependencies
      run: |
        if [ -f "Spot Saver/Podfile" ]; then 
            cd "Spot Saver" && pod install && cd ..
        fi

    - name: Build & Test
      run: |
        # I assumed your project is inside a folder named "Spot Saver".
        # If the error persists, check the "List files" log to see the real folder name.
        
        xcodebuild \
        -project "Spot Saver/Spot Saver.xcodeproj" \
        -scheme "Spot Saver" \
        -destination 'platform=iOS Simulator,name=iPhone 16' \
        clean test
